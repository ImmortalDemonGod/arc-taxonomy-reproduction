======================================================================
TaskEncoder Component Tests
======================================================================

Test Data:
  Batch size: 4
  Num demos: 3
  Grid size: 30x30
  Demo input shape: torch.Size([4, 3, 30, 30])
  Demo output shape: torch.Size([4, 3, 30, 30])

======================================================================
Test 1: TaskEncoderCNN (Version A - Simple CNN)
======================================================================
  âœ… Model created: 420,976 parameters
  âœ… Forward pass works (inference)
     Input: torch.Size([4, 3, 30, 30])
     Output: torch.Size([4, 256])
  âœ… Output shape correct: (4, 256)
  âœ… Backward pass works (training)

  ðŸŽ‰ TaskEncoderCNN (Version A) works!

======================================================================
Test 2: TaskEncoderAdvanced (Version B - Champion's ContextEncoder)
======================================================================
  âœ… Model created: 1,246,688 parameters
  âœ… Forward pass works (inference)
     Input: torch.Size([4, 3, 30, 30])
     Output: torch.Size([4, 256])
  âœ… Output shape correct: (4, 256)
  âœ… Backward pass works (training)

  ðŸŽ‰ TaskEncoderAdvanced (Version B) works!

======================================================================
Test 3: Both models with embed_dim=400 (Phase 2)
======================================================================
  âœ… CNN output: torch.Size([4, 400])
  âœ… Advanced output: torch.Size([4, 400])

  ðŸŽ‰ Both models work with Phase 2 dimensions!

======================================================================
Test 4: Classification Head (Direct Classification - Phase 1)
======================================================================
  âœ… Encoder output: torch.Size([4, 256])
  âœ… Classifier logits: torch.Size([4, 9])
  âœ… Probabilities: torch.Size([4, 9])
  âœ… Predictions: torch.Size([4])
     Sample predictions: [6, 6, 6, 6]

  ðŸŽ‰ Classification pipeline works!

======================================================================
ðŸŽ‰ ALL TESTS PASSED
======================================================================

Components verified:
  âœ… TaskEncoderCNN (Version A) - 420,976 params
  âœ… TaskEncoderAdvanced (Version B) - 1,246,688 params
  âœ… Forward/backward passes work
  âœ… Phase 1 dimensions (256) work
  âœ… Phase 2 dimensions (400) work
  âœ… Classification head works

Ready for:
  1. Phase 1C: Direct classification training
  2. Phase 2B: Oracle-predictor training
======================================================================
